<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contagem Regressiva para o Retorno</title>
    <style>
        /* Os estilos (CSS) continuam os mesmos */
        body, html {
            height: 100%;
            margin: 0;
            font-family: 'Arial', sans-serif;
            color: white;
            overflow: hidden;
        }
        .background-container {
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/0/05/Flag_of_Brazil.svg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
        }
        h1 {
            font-size: 5rem;
            font-weight: bold;
            color: #FFDF00;
            margin-bottom: 20px;
        }
        #countdown {
            font-size: 2.5rem;
            background-color: rgba(0, 39, 118, 0.7);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #FFDF00;
            min-width: 600px; /* Garante espaço para a mensagem */
        }
        #info-data-inicio {
            margin-top: 20px;
            font-size: 1rem;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
        }
        @media (max-width: 768px) {
            h1 {
                font-size: 3rem;
            }
            #countdown {
                font-size: 1.5rem;
                min-width: 90%;
            }
        }
    </style>
</head>
<body>

    <div class="background-container">
        <h1>Volta do Mito</h1>
        <div id="countdown">Buscando a hora certa para iniciar a contagem...</div>
        <div id="info-data-inicio"></div>
    </div>

    <script>
        const countdownElement = document.getElementById('countdown');
        const infoDataInicioElement = document.getElementById('info-data-inicio');
        
        // URL da API de tempo para o fuso horário de São Paulo
        const timeApiUrl = 'https://worldtimeapi.org/api/timezone/America/Sao_Paulo';
        
        let intervalo; // Variável para guardar o setInterval

        // Função principal que inicia a contagem
        async function iniciarContagemComHoraAPI() {
            try {
                // 1. Faz a chamada à API
                const response = await fetch(timeApiUrl);
                if (!response.ok) {
                    // Se a resposta da API não for bem-sucedida, lança um erro
                    throw new Error('Falha na rede ao buscar a hora.');
                }
                const dados = await response.json();
                
                // 2. Usa a data e hora da API como ponto de partida
                const dataInicio = new Date(dados.datetime);
                
                iniciar(dataInicio, "Horário oficial de Brasília (via API)");

            } catch (error) {
                console.error("Erro ao buscar hora da API:", error);
                // 3. Plano B: Se a API falhar, usa a hora local do PC
                const dataInicioLocal = new Date();
                iniciar(dataInicioLocal, "API indisponível, usando hora local do seu PC");
            }
        }

        // Função que configura e inicia o relógio
        function iniciar(dataInicio, origem) {
            infoDataInicioElement.textContent = `Origem do tempo: ${origem}`;

            // Calcula a data alvo (27 anos e 3 meses no futuro)
            const dataAlvo = new Date(dataInicio.getTime());
            dataAlvo.setFullYear(dataAlvo.getFullYear() + 27);
            dataAlvo.setMonth(dataAlvo.getMonth() + 3);

            // Inicia o intervalo que atualiza o relógio a cada milissegundo
            intervalo = setInterval(() => atualizarContagem(dataAlvo), 1);
        }

        // Função que atualiza a contagem na tela
        function atualizarContagem(dataAlvo) {
            const agora = new Date(); // Pega a hora atual do cliente para calcular a diferença
            const diferenca = dataAlvo - agora;

            if (diferenca <= 0) {
                countdownElement.innerHTML = "A contagem chegou ao fim!";
                clearInterval(intervalo);
                return;
            }

            const totalSegundos = Math.floor(diferenca / 1000);
            const totalMinutos = Math.floor(totalSegundos / 60);
            const totalHoras = Math.floor(totalMinutos / 60);
            const totalDias = Math.floor(totalHoras / 24);

            let anos = Math.floor(totalDias / 365.25);
            let meses = Math.floor((totalDias % 365.25) / 30.44);
            let semanas = Math.floor(((totalDias % 365.25) % 30.44) / 7);
            let dias = Math.floor(((totalDias % 365.25) % 30.44) % 7);
            
            let horas = totalHoras % 24;
            let minutos = totalMinutos % 60;
            let segundos = totalSegundos % 60;
            let milissegundos = diferenca % 1000;

            const pad = (num) => num.toString().padStart(2, '0');
            const padMs = (num) => num.toString().padStart(3, '0');

            countdownElement.innerHTML = `
                ${anos} anos, ${meses} meses, ${semanas} semanas, ${dias} dias <br>
                ${pad(horas)}:${pad(minutos)}:${pad(segundos)}:${padMs(milissegundos)}
            `;
        }

        // Chama a função principal para dar início a todo o processo
        iniciarContagemComHoraAPI();
    </script>

</body>
</html>
